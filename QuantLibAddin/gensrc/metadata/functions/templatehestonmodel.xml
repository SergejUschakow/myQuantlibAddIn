<Category name='templatehestonmodel'>
  <description>functions and methods for Heston-style models.</description>
  <displayName>Heston Model</displayName>
  <xlFunctionWizardCategory>QuantLib - Financial</xlFunctionWizardCategory>
  <serializationIncludes>
    <include>qlo/conversions/coercetermstructure.hpp</include>
    <include>qlo/baseinstruments.hpp</include>
    <include>qlo/termstructures.hpp</include>
    <include>qlo/pricingengines.hpp</include>
    <include>qlo/bonds.hpp</include>
    <include>qlo/templatehestonmodel.hpp</include>    
  </serializationIncludes>
  <addinIncludes>
    <include>qlo/handleimpl.hpp</include>
    <include>qlo/conversions/coercetermstructure.hpp</include>
    <include>qlo/baseinstruments.hpp</include>
    <include>qlo/termstructures.hpp</include>
    <include>qlo/pricingengines.hpp</include>
    <include>qlo/bonds.hpp</include>
    <include>qlo/templatehestonmodel.hpp</include>
  </addinIncludes>
  <copyright>
    Copyright (C) 2012, Sebastian Schlenkrich
  </copyright>
  <Functions>
  
    <Constructor name='qlHestonProcess'>
      <libraryFunction>HestonProcess</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='RiskFreeRate'>
            <type>QuantLib::YieldTermStructure</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>YieldTermStructure for discounting.</description>
          </Parameter>
          <Parameter name='DividendYield'>
            <type>QuantLib::YieldTermStructure</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>YieldTermStructure for dividends.</description>
          </Parameter>
          <Parameter name='S0'>
            <type>QuantLib::Quote</type>
            <superType>libToHandle</superType>
            <tensorRank>scalar</tensorRank>
            <description>Asset initial state S(0).</description>
          </Parameter>
          <Parameter name='V0' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility initial state v(0).</description>
          </Parameter>
          <Parameter name='Kappa' default='0.10' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion speed.</description>
          </Parameter>
          <Parameter name='Theta' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion level.</description>
          </Parameter>
          <Parameter name='Sigma' default='0.50' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility of volatility.</description>
          </Parameter>
          <Parameter name='Rho' default='0.00' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Instantanous asset vol correlation.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlHestonModel'>
      <libraryFunction>HestonModel</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='HestonProcess'>
            <type>QuantLib::HestonProcess</type>
            <tensorRank>scalar</tensorRank>
            <description>Reference to Heston process.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlAnalyticHestonEngine'>
      <libraryFunction>AnalyticHestonEngine</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='HestonModel'>
            <type>QuantLib::HestonModel</type>
            <tensorRank>scalar</tensorRank>
            <description>Reference to Heston model.</description>
          </Parameter>
          <Parameter name='RelTolerance'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Relative tolerance for numeric integration.</description>
          </Parameter>
          <Parameter name='MaxEvaluations'>
            <type>QuantLib::Size</type>
            <tensorRank>scalar</tensorRank>
            <description>Maximal number of function evaluations in numeric integration.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <Constructor name='qlRealHestonModel'>
      <libraryFunction>RealHestonModel</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='Kappa' default='0.10' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion speed.</description>
          </Parameter>
          <Parameter name='Theta' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion level.</description>
          </Parameter>
          <Parameter name='Sigma' default='0.50' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility of volatility.</description>
          </Parameter>
          <Parameter name='Rho' default='0.00' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Instantanous asset vol correlation.</description>
          </Parameter>
          <Parameter name='V0' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility initial state v(0).</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- RealHestonModel interface -->
    <Member name='qlRealHestonModelVanillaOption' type='QuantLib::RealHestonModel' >
      <description>Returns a future zero coupon bond price in the Hull White model.</description>
      <libraryFunction>vanillaOption</libraryFunction>
      <SupportedPlatforms>
        <!--SupportedPlatform name='Excel' calcInWizard='false'/-->
        <SupportedPlatform name='Excel'/>
        <!--SupportedPlatform name='Calc'/-->
        <!--SupportedPlatform name='Cpp'/-->
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ForwardPrice' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Forward price of underlying asset.</description>
          </Parameter>
          <Parameter name='StrikePrice' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Strike price of option.</description>
          </Parameter>
          <Parameter name='Term' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Time</type>
            <tensorRank>scalar</tensorRank>
            <description>Time to exercise (in year fraction).</description>
          </Parameter>
          <Parameter name='CallOrPut' exampleValue ='1' default='1'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>Call (+1) or Put (-1) option.</description>
          </Parameter>
          <Parameter name='Accuracy' exampleValue ='1.0e-4' default='1.0e-4'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Accuracy for integration.</description>
          </Parameter>
          <Parameter name='MaxEvaluations' exampleValue ='1000' default='1000'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>Maximum number of integrand function evaluations in integration.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Real</type>
        <tensorRank>scalar</tensorRank>
      </ReturnValue>
    </Member>

    <Constructor name='qlActiveHestonModel'>
      <libraryFunction>ActiveHestonModel</libraryFunction>
      <SupportedPlatforms>
        <SupportedPlatform name='Excel'/>
        <SupportedPlatform name='Cpp'/>
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='Kappa' default='0.10' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion speed.</description>
          </Parameter>
          <Parameter name='Theta' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility mean reversion level.</description>
          </Parameter>
          <Parameter name='Sigma' default='0.50' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility of volatility.</description>
          </Parameter>
          <Parameter name='Rho' default='0.00' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Instantanous asset vol correlation.</description>
          </Parameter>
          <Parameter name='V0' default='0.15' const='False'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Volatility initial state v(0).</description>
          </Parameter>
        </Parameters>
      </ParameterList>
    </Constructor>

    <!-- ActiveHestonModel interface -->
    <Member name='qlActiveHestonModelVanillaOption' type='QuantLib::ActiveHestonModel' >
      <description>Returns a future zero coupon bond price in the Hull White model.</description>
      <libraryFunction>vanillaOption</libraryFunction>
      <SupportedPlatforms>
        <!--SupportedPlatform name='Excel' calcInWizard='false'/-->
        <SupportedPlatform name='Excel'/>
        <!--SupportedPlatform name='Calc'/-->
        <!--SupportedPlatform name='Cpp'/-->
      </SupportedPlatforms>
      <ParameterList>
        <Parameters>
          <Parameter name='ForwardPrice' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Forward price of underlying asset.</description>
          </Parameter>
          <Parameter name='StrikePrice' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Strike price of option.</description>
          </Parameter>
          <Parameter name='Term' exampleValue ='1.0' default='1.0'>
            <type>QuantLib::Time</type>
            <tensorRank>scalar</tensorRank>
            <description>Time to exercise (in year fraction).</description>
          </Parameter>
          <Parameter name='CallOrPut' exampleValue ='1' default='1'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>Call (+1) or Put (-1) option.</description>
          </Parameter>
          <Parameter name='Accuracy' exampleValue ='1.0e-4' default='1.0e-4'>
            <type>QuantLib::Real</type>
            <tensorRank>scalar</tensorRank>
            <description>Accuracy for integration.</description>
          </Parameter>
          <Parameter name='MaxEvaluations' exampleValue ='1000' default='1000'>
            <type>long</type>
            <tensorRank>scalar</tensorRank>
            <description>Maximum number of integrand function evaluations in integration.</description>
          </Parameter>
        </Parameters>
      </ParameterList>
      <ReturnValue>
        <type>QuantLib::Real</type>
        <tensorRank>vector</tensorRank>
      </ReturnValue>
    </Member>



  </Functions>
</Category>
